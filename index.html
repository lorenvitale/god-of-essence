<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>God of Essence · Formulatore Profumi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;600;700&family=Manrope:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="hero">
      <div class="hero__overlay"></div>
      <div class="hero__content">
        <div class="hero__brand">
          <span class="hero__logo" aria-hidden="true">
            <svg viewBox="0 0 88 88" role="presentation" focusable="false">
              <defs>
                <radialGradient id="logo-glow" cx="50%" cy="35%" r="60%">
                  <stop offset="0%" stop-color="#ffe8a3" />
                  <stop offset="45%" stop-color="#f2b705" />
                  <stop offset="100%" stop-color="#7a3aff" />
                </radialGradient>
                <linearGradient id="logo-bottle" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#2c1a5a" />
                  <stop offset="45%" stop-color="#f5d26a" />
                  <stop offset="100%" stop-color="#d874ff" />
                </linearGradient>
              </defs>
              <circle cx="44" cy="44" r="40" fill="url(#logo-glow)" opacity="0.6" />
              <path
                d="M44 16c6.6 0 12 5.4 12 12v3.4c0 2.8 1 5.4 2.8 7.5 4.5 5.2 7.2 11.9 7.2 19.1C66 70.9 56.9 80 45 80S24 70.9 24 58c0-7.2 2.7-13.9 7.2-19.1 1.8-2.1 2.8-4.7 2.8-7.5V28c0-6.6 5.4-12 12-12Z"
                fill="url(#logo-bottle)"
                opacity="0.95"
              />
              <path
                d="M44 32c-5.5 0-10 4.5-10 10 0 7 4.5 8.5 7.2 11.6 2.2 2.5 2.8 4.8 2.8 8.4 0-3.6 0.6-5.9 2.8-8.4C49.5 50.5 54 49 54 42c0-5.5-4.5-10-10-10Z"
                fill="#0b0f1d"
                opacity="0.75"
              />
              <path
                d="M38 26h12c1.7 0 3-1.3 3-3s-1.3-3-3-3H38c-1.7 0-3 1.3-3 3s1.3 3 3 3Z"
                fill="#f9f6ff"
                opacity="0.65"
              />
              <circle cx="44" cy="44" r="6" fill="#fff8d5" opacity="0.75" />
            </svg>
          </span>
          <h1 class="hero__title">GOD OF ESSENCE</h1>
        </div>
        <h2 class="hero__subtitle">Formulatore di Profumi</h2>
        <p>
          Disegna accordi unici con una libreria di essenze pregiate, gestisci i
          test batch e scopri la piramide olfattiva perfetta.
        </p>
        <div class="hero__actions">
          <button id="start-builder" class="btn btn--primary">
            Crea una nuova formula
          </button>
          <button id="open-import" class="btn btn--ghost">
            Carica formula
          </button>
        </div>
      </div>
    </header>

    <main class="layout">
      <aside class="panel">
        <section class="panel__section">
          <div class="panel__header">
            <h2>Database Essenze</h2>
            <input
              type="search"
              id="search-essence"
              placeholder="Cerca nota, famiglia, naturale..."
              aria-label="Cerca essenza"
            />
          </div>
          <div class="pill-filter" id="family-filter"></div>
          <div class="panel__status" id="sync-status" aria-live="polite">
            Libreria locale caricata, sincronizzazione avanzata pronta.
          </div>
          <ul class="essence-list" id="essence-list" aria-live="polite"></ul>
        </section>
      </aside>

      <section class="workspace" aria-live="polite">
        <div class="workspace__intro" id="workspace-intro">
          <h2>Inizia dal concept</h2>
          <p>
            Scegli le materie prime dalla libreria, imposta il batch di test e
            definisci la tua piramide olfattiva. Tutto aggiornato in tempo reale
            con percentuali, ml, grammi e gocce.
          </p>
        </div>

        <div class="workspace__content" id="workspace" hidden>
          <section class="card card--glass" aria-labelledby="batch-heading">
            <div class="card__header">
              <h2 id="batch-heading">Impostazioni Batch</h2>
              <button class="btn btn--ghost" id="load-formula">Carica formula salvata</button>
            </div>
            <form class="form-grid" id="batch-form">
              <label>
                Nome formula
                <input type="text" id="formula-name" placeholder="Es. Aurora Notturna" required />
              </label>
              <label>
                Tipologia
                <select id="batch-type">
                  <option value="EDP">Eau de Parfum (EDP)</option>
                  <option value="EDT">Eau de Toilette (EDT)</option>
                  <option value="PARFUM">Parfum</option>
                  <option value="COLOGNE">Cologne</option>
                </select>
              </label>
              <label>
                Volume batch
                <div class="input-with-unit">
                  <input type="number" id="batch-volume" min="1" value="10" />
                  <span>ml</span>
                </div>
              </label>
              <label>
                Densità media
                <div class="input-with-unit">
                  <input type="number" id="density" min="0.5" step="0.01" value="0.96" />
                  <span>g/ml</span>
                </div>
              </label>
              <label>
                Concentrazione aromi
                <div class="input-with-unit">
                  <input type="number" id="concentration" min="1" max="50" value="18" />
                  <span>%</span>
                </div>
              </label>
              <label>
                Note creative
                <textarea id="formula-notes" rows="1" placeholder="Mood, ispirazioni, contesto" spellcheck="false"></textarea>
              </label>
            </form>
          </section>

          <section class="card card--glass" aria-labelledby="composition-heading">
            <div class="card__header">
              <h2 id="composition-heading">Composizione</h2>
              <div class="card__actions">
                <button class="btn btn--ghost" id="clear-selection">Svuota</button>
              </div>
            </div>
            <div class="composition" id="composition"></div>
            <div class="card__footer" id="composition-summary"></div>
          </section>

          <section class="card card--glass" aria-labelledby="evaluation-heading">
            <div class="card__header">
              <h2 id="evaluation-heading">Valutazione &amp; Piramide</h2>
              <div class="badge" id="olfactory-family">—</div>
            </div>
            <form class="evaluation" id="evaluation-form">
              <label>
                Voto complessivo
                <input type="range" id="rating" min="0" max="10" step="0.5" value="8" />
                <output for="rating" id="rating-output">8</output>
              </label>
              <label>
                Piramide olfattiva
                <div class="pyramid note-switcher" id="pyramid" data-note-switcher>
                  <div
                    class="note-switcher__tabs"
                    role="tablist"
                    aria-label="Categorie della piramide olfattiva"
                  >
                    <button
                      type="button"
                      class="note-switcher__tab note-switcher__tab--active"
                      id="tab-top-notes"
                      role="tab"
                      aria-selected="true"
                      aria-controls="panel-top-notes"
                    >
                      Note di Testa
                    </button>
                    <button
                      type="button"
                      class="note-switcher__tab"
                      id="tab-heart-notes"
                      role="tab"
                      aria-selected="false"
                      aria-controls="panel-heart-notes"
                    >
                      Note di Cuore
                    </button>
                    <button
                      type="button"
                      class="note-switcher__tab"
                      id="tab-base-notes"
                      role="tab"
                      aria-selected="false"
                      aria-controls="panel-base-notes"
                    >
                      Note di Fondo
                    </button>
                  </div>
                  <div class="note-switcher__panels">
                    <section
                      id="panel-top-notes"
                      class="note-switcher__panel"
                      role="tabpanel"
                      aria-labelledby="tab-top-notes"
                    >
                      <label class="note-switcher__label" for="top-notes">Note di Testa</label>
                      <textarea
                        id="top-notes"
                        rows="2"
                        placeholder="Agrumi, Lavanda..."
                      ></textarea>
                    </section>
                    <section
                      id="panel-heart-notes"
                      class="note-switcher__panel"
                      role="tabpanel"
                      aria-labelledby="tab-heart-notes"
                      hidden
                    >
                      <label class="note-switcher__label" for="heart-notes">Note di Cuore</label>
                      <textarea
                        id="heart-notes"
                        rows="2"
                        placeholder="Gelsomino, Rosa..."
                      ></textarea>
                    </section>
                    <section
                      id="panel-base-notes"
                      class="note-switcher__panel"
                      role="tabpanel"
                      aria-labelledby="tab-base-notes"
                      hidden
                    >
                      <label class="note-switcher__label" for="base-notes">Note di Fondo</label>
                      <textarea
                        id="base-notes"
                        rows="2"
                        placeholder="Ambra, Patchouli..."
                      ></textarea>
                    </section>
                  </div>
                </div>
              </label>
              <label>
                Sensazioni
                <textarea id="impressions" rows="3" placeholder="Proiezione, evoluzione, contesto d'uso"></textarea>
              </label>
              <div class="evaluation__actions">
                <button type="button" class="btn btn--ghost" id="restore-ai">Suggerimenti AI</button>
                <button type="button" class="btn btn--ghost" id="duplicate-formula">Duplica</button>
                <button type="button" class="btn btn--primary" id="save-formula">Salva formula</button>
              </div>
            </form>
          </section>
        </div>
      </section>
    </main>

    <template id="composition-row-template">
      <div class="composition__row">
        <div class="composition__meta">
          <h3 class="composition__name"></h3>
          <p class="composition__details"></p>
        </div>
        <div class="composition__inputs">
          <label class="slider">
            <span>Percentuale</span>
            <input type="range" min="0" max="100" step="0.5" />
            <output>0%</output>
          </label>
          <div class="composition__metrics">
            <div>
              <span class="metric__label">ml</span>
              <span class="metric__value" data-unit="ml">0</span>
            </div>
            <div>
              <span class="metric__label">g</span>
              <span class="metric__value" data-unit="g">0</span>
            </div>
            <div>
              <span class="metric__label">gocce</span>
              <span class="metric__value" data-unit="drops">0</span>
            </div>
          </div>
          <button class="btn-icon" type="button" aria-label="Rimuovi">
            <span>&times;</span>
          </button>
        </div>
      </div>
    </template>

    <template id="saved-formulas-template">
      <dialog class="modal" id="saved-formulas-modal">
        <div class="modal__content">
          <h2>Gestisci le tue formule</h2>
          <div class="modal__grid">
            <section class="modal__column">
              <h3>Formule salvate</h3>
              <p id="saved-formulas-empty" class="modal__empty" hidden>
                Nessuna formula salvata al momento. Salva una composizione o importa un file esterno.
              </p>
              <ul id="saved-formulas-list"></ul>
            </section>
            <section class="modal__column">
              <h3>Importa da file</h3>
              <p class="modal__hint">
                Carica una formula in formato PDF, Excel o CSV. Il sistema abbinerà automaticamente le materie prime conosciute.
              </p>
              <label class="upload-card" for="external-formula-file">
                <input
                  type="file"
                  id="external-formula-file"
                  accept=".pdf,.xlsx,.xls,.csv"
                  aria-label="Carica file formula"
                  hidden
                />
                <span class="upload-card__icon" aria-hidden="true">📤</span>
                <span class="upload-card__label">Trascina o seleziona file</span>
                <span class="upload-card__hint">PDF, XLSX, XLS o CSV</span>
              </label>
              <p class="modal__hint modal__hint--small">
                Suggerimento: utilizza il report di esportazione per avere un tracciato compatibile.
              </p>
            </section>
          </div>
          <div class="modal__actions">
            <button class="btn btn--ghost" id="close-saved">Chiudi</button>
          </div>
        </div>
      </dialog>
    </template>

    <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.min.js"></script>
    <script defer src="app.bundle.js"></script>
  </body>
</html>
